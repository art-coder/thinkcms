<extend name="Layout/base"/>
<block name="current">栏目管理</block>
<block name="breadcrumb">
    <li><a href="{:U('Category/index')}"><i class="fa fa-book"></i>&nbsp;栏目管理</a></li>
    <li class="active"><if condition="($action eq 'edit') AND ($category_id gt 0)">编辑栏目<else/>添加栏目</if></li>
</block>
<block name="content">
    <form id="addform" action="{:U('save')}" class="form-horizontal" method="post" enctype="multipart/form-data">
        <input type="hidden" name="id"  value="{$category_info.id}"/>

        <div class="form-group">
            <label for="title" class="col-sm-2 control-label">栏目名称：</label>

            <div class="col-sm-3">
                <input type="text" value="{$category_info.title}" name="title" id="title"
                       placeholder="栏目名称"
                       class="form-control small" required>
            </div>
        </div>

        <div class="form-group ">
            <label class="col-sm-2 control-label">所属栏目：</label>

            <div class="col-sm-3">
                <select name="pid" class="form-control">
                    <option value="0" {$category_info['pid'] ? '' : 'selected'}>顶级栏目</option>
                    <foreach name='category_list' item='v'>
                        <option value="{$v.id}" {$category_info['pid'] == $v['id'] ? 'selected' : ''}>
                                {$v.delimiter}{$v.title}
                        </option>
                    </foreach>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">是否开启封面：</label>

            <div class="col-sm-3">
                <label class="radio-inline">
                    <input type="radio" class="js_hasCover" name="has_cover" value="1" {$category_info['has_cover'] ? 'checked' : ''}> 是
                </label>
                <label class="radio-inline">
                    <input type="radio" class="js_hasCover" name="has_cover" value="0" {$category_info['has_cover'] ? '' : 'checked'}> 否
                </label>
            </div>
        </div>

        <div class="form-group js_coverBox {$category_info['has_cover'] ? '' : hidden }">
            <label for="title" class="col-sm-2 control-label">封面图：</label>

            <div class="col-sm-5">
                <input type="file" name="cover_file" class="form-control small">
                <input type="hidden" name="cover" value="{$category_info['cover']}"/>
                <if condition="$category_info['cover']">
                    <div><img id="js_logoBox" src="{$category_info['cover']}"></div>
                </if>
            </div>
        </div>

        <div class="form-group">
            <label for="content" class="col-sm-2 control-label">单页内容：</label>

            <div class="col-sm-8">
                <textarea class="form-control" rows="5" name="content" id="content">{$category_info.content}</textarea>
            </div>
        </div>

        <div class="form-group">
            <label for="sort" class="col-sm-2 control-label">排序(越小越靠前)：</label>

            <div class="col-sm-1">
                <input type="text" value="{$category_info.sort|default=1}" name="sort" id="sort"
                       placeholder="排序号只能为1-2位数字"
                       class="form-control small" required>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">是否显示(前台)：</label>

            <div class="col-sm-3">
                <label class="radio-inline">
                    <input type="radio" name="is_show" value="1" {$category_info['is_show'] ? 'checked' : ''}> 显示
                </label>
                <label class="radio-inline">
                    <input type="radio" name="is_show" value="0" {$category_info['is_show'] ? '' : 'checked'}> 隐藏
                </label>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">栏目状态：</label>

            <div class="col-sm-3">
                <label class="radio-inline">
                    <input type="radio" name="status" value="1" {$category_info['status'] ? 'checked' : ''}> 启用
                </label>
                <label class="radio-inline">
                    <input type="radio" name="status" value="0" {$category_info['status'] ? '' : 'checked'}> 禁用
                </label>
            </div>
        </div>

        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default">保存</button>
            </div>
        </div>
    </form>
</block>

<block name="script">
    <script>
        $(function () {
            $(".js_hasCover").change(function () {
                var hasCover = $(".js_hasCover:checked").val();
                if (hasCover == 1) {
                    $(".js_coverBox").removeClass('hidden').addClass('show');
                } else {
                    $(".js_coverBox").removeClass('show').addClass('hidden');
                }
            });
        })
    </script>
</block>